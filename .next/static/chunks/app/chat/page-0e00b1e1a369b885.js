(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{3261:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>C});var o=r(95155),t=r(12115),s=r(35695),a=r(12108),i=r(5951),c=r(18949),l=r(31807),m=r(60838);let d=e=>fetch(e).then(e=>e.json());function h(e,n){let{data:r,error:o,isLoading:t}=(0,m.Ay)(e,d);return{[n[0]]:r,[n[1]]:o,[n[2]]:t}}function g(e){let n=e.roomId,{json:r,jsonLoading:t,jsonError:s}=h("../api/message?roomId=".concat(n),["json","jsonLoading","jsonError"]);if(n<0)return(0,o.jsx)(o.Fragment,{});if(0==n)return(0,o.jsx)("p",{children:"Please select a room on the bottom"});if(t)return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Loading"})});if(s&&!0!==s)return console.error(s),(0,l.$U)({color:"danger",title:"Something went wrong getting the messages",description:"More info in developer console"}),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Error"})});if(void 0==r)return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Error"})});let a=r.messages,m=r.users;return 0===a.length?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"There are no messages as of now, how about you start the converatation?"})}):(0,o.jsx)(o.Fragment,{children:a.map(e=>(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(i.Q,{src:m[e.user][0].pfp})," ",(0,o.jsx)("span",{children:m[e.user][0].name}),(0,o.jsx)("p",{children:e.content})]},e.id))})}var p=r(66749),u=r(22949),x=r(39156),j=r(57172),f=r.n(j);function _(e){let n=e.roomId;return(0,o.jsxs)(p.l,{onSubmit:function(e){e.preventDefault();let r=Object.fromEntries(new FormData(e.currentTarget)).content.toString();0!==r.trim().length&&fetch("/api/message",{method:"POST",body:JSON.stringify({content:"".concat(r),roomId:"".concat(n)})}).catch(e=>{console.error(e),(0,l.$U)({color:"danger",title:"Somethign went wrong sending your message",description:"More info in developer console"})})},className:"".concat(f().form),children:[(0,o.jsx)(x.r,{placeholder:"What do you want to send to the internet?",type:"text",name:"content",className:"".concat(f().input)}),(0,o.jsx)(u.T,{type:"submit",color:"default",className:"".concat(f().button),children:"Send"})]})}function b(e){let n=e.roomId;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g,{roomId:n}),(0,o.jsx)(_,{roomId:n})]})}function v(e){e.roomId;let n=e.setRoom,{json:r,jsonError:t,jsonLoading:s}=h("../api/rooms/user",["json","jsonError","jsonLoading"]);if(s)return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Loading"})});if(t&&"true"!=t)return console.error(t),(0,l.$U)({color:"danger",title:"Some went wrong getting your rooms",description:"More info in the developer console"}),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Error"})});let a=r.rooms;if(0===a.length)return(0,o.jsx)(o.Fragment,{});function i(e){n(e.target.id)}return(0,o.jsx)("span",{className:"flex flex-wrap gap-1",children:a.map(e=>(0,o.jsx)(u.T,{onPress:i,id:e.id.toString(),children:e.name},e.id))})}var w=r(80306),N=r(12153),y=r(50340),F=r(84520),S=r(1493);function I(){let{isOpen:e,onOpen:n,onOpenChange:r}=(0,w.j)();function t(e){e.preventDefault();let n=Object.fromEntries(new FormData(e.currentTarget)).roomName.toString();if(0===n.trim().length)return void(0,l.$U)({color:"danger",title:"All rooms need a title",description:"Try creating a room with a name this time. Rooms have feeling too ya know"});(0,l.$U)({title:"Creating room",color:"primary",promise:fetch("../api/rooms/server",{method:"POST",body:JSON.stringify({name:n})})})}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.T,{onPress:n,children:"Create Room"}),(0,o.jsx)(N.Y,{isOpen:e,onOpenChange:r,children:(0,o.jsx)(y.g,{children:e=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(F.c,{children:"New Room"}),(0,o.jsx)(S.h,{children:(0,o.jsxs)(p.l,{onSubmit:t,children:[(0,o.jsx)(x.r,{type:"text",label:"Room name",name:"roomName"}),(0,o.jsx)(u.T,{type:"submit",children:"Create room"})]})})]})})})]})}function E(e){let n=e.room,r=e.setRoom;return(0,o.jsxs)("span",{className:"flex flex-wrap gap-2",children:[(0,o.jsx)(v,{roomId:n,setRoom:r}),(0,o.jsx)(I,{})]})}var O=r(13974),R=r(69435);function T(e){let n=e.room,{json:r,jsonError:t,jsonLoading:s}=h("../api/rooms/server?roomId=".concat(n),["json","jsonError","jsonLoading"]);if(n<=0)return(0,o.jsx)(o.Fragment,{});if(s)return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("p",{children:"Loading"})});t&&!0!==r&&(0,l.$U)({color:"danger",title:"Something went wrong geting active users",description:"Mroe info in developer console"});let a=r.people;return(0,o.jsx)(O.K,{classNames:{base:"max-w-xs",list:"max-h-[300px] overflow-scroll"},items:a,children:a.map(e=>(0,o.jsx)(R.y,{textValue:e.name,children:(0,o.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,o.jsx)(i.Q,{alt:e.name,className:"shrink-0",size:"sm",src:e.pfp||""}),(0,o.jsx)("div",{className:"flex flex-col",children:(0,o.jsx)("span",{className:"text-small",children:e.name})})]})},e.githubId))})}var L=r(10495),M=r.n(L);function C(){let{data:e,status:n}=(0,a.useSession)(),r=(0,s.useRouter)(),[i,c]=(0,t.useState)(0);try{if("unauthenticated"===n)return r.replace("/api/auth/signin"),(0,o.jsx)("p",{children:"Acess Denied, you need to be loged in to view this page"});return(0,o.jsxs)("div",{className:"".concat(M().page),children:[(0,o.jsxs)("div",{className:"".concat(M().main),children:[(0,o.jsx)(b,{roomId:i,className:"".concat(M().chat)}),(0,o.jsx)("div",{className:"".concat(M().members),children:(0,o.jsx)(T,{room:i})})]}),(0,o.jsxs)("div",{className:"".concat(M().bottom),children:[(0,o.jsx)(E,{room:i,setRoom:c,className:"".concat(M().rooms)}),(0,o.jsx)("div",{className:"".concat(M().managment)})]})]})}catch(e){return r.replace("/api/auth/signin"),(0,o.jsx)("p",{children:"Acess Denied, you need to be loged in to view this page"})}}},10495:e=>{e.exports={page:"page_page__f47sj",main:"page_main__iHbbF",chat:"page_chat__4zXmo",members:"page_members__hR6Fh",bottom:"page_bottom__MuQ4y",rooms:"page_rooms__CnPB8",managment:"page_managment__4lJie"}},57172:e=>{e.exports={form:"createMessage_form__w4Lhm",input:"createMessage_input__o_YI5",button:"createMessage_button__9LOxl"}},76566:(e,n,r)=>{Promise.resolve().then(r.bind(r,3261))}},e=>{e.O(0,[462,807,668,454,402,441,964,358],()=>e(e.s=76566)),_N_E=e.O()}]);